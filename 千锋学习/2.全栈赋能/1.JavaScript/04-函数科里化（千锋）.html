<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // 函数科里化 : 
        // 科里化是一种函数转换方式 , 是高阶函数的一种; 
        //  - 将一个接收多个参数的函数 , 转换为接收部分参数的函数; 
        // 科里化的函数只传递部分参数来进行应用 , 每次都会返回一个新的函数 , 处理剩余的参数! 
        // 科里化应用是逐步传参过程的应用; 

        // function sum( a , b , c ){
        //     return a + b + c;
        // }
        // let res1 = sum( 1 , 2 , 3 )
        // console.log( res1 );
        // 科里化 : 
        // function _sum( a ){
        //     // 科里化函数返回的是新的函数 , 新的函数用来接收剩余的参数; 
        //     return function(b){
        //         return function(c){
        //             return a + b + c ;
        //         }
        //     }
        // }
        // let res2 = _sum( 1 )( 2 )( 3 );
        // console.log( res2 );

        // 科里化函数封装 : 
        function sum( a , b , c , d ){
            return a + b + c + d ;
        }

        function curry( fn , args = [] ){
            // 科里化函数要返回一个新的函数; 
            // fn   : 就是参与最终计算的函数; 
            // args : 配置参数;  ( 难点 )
            
            // 注意 : 科里化函数封装核心在于判断当前传入的参数总数,是不是和函数需求的参数数量相同! 
            // - 函数的参数数量;  函数.length 这种方式进行获取的; 
            // console.log( fn.length );
            // 目标函数的总数量! 
            let num = fn.length ; 
            // - 总共传入了多少参数; 
            // 注意 : 我们在传递参数的时候是向匿名函数之中传参的, 如果我们想要记录总数, 就需要在匿名函数外部进行记录! 我们使用args变量进行记录! 
            // 给 args 设置一个默认参数; 
            return function( ..._args ){
                // ...args表示传入的所有参数都以数组的形式进行接收; 
                // 我们进行参数拼接 : 参数拼接的目的是获取当前参数和之前记录的参数进行总股数拼接; 
                _args = args.concat( _args );
                // 我们判断当前拼接好的参数数量是不是和我们的函数需求的参数数量一致! 
                // - 如果一致我们进行计算
                if( _args.length === num ){
                    return fn(..._args);
                }
                if( _args.length < num ){
                    // - 如果不一致, 我们重新调用curry函数返回匿名函数; 
                    // - 我们把已经拼接好的数组给传递进去; 
                    return curry( fn , _args );
                }
            }
        }

        // 使用基础版本的科里化函数 : 
        let _sum = curry( sum );
        let res1 = _sum(1,2)(3)(4);
        let res2 = _sum(1)(3)(4)(2);
        let res3 = _sum(1,3)(4,2);
        console.log(res1 , res2 , res3);

        // 我们可以提取部分重复使用的参数, 简化最终计算时函数参数的传入; 
        // 我们可以设置初始值, 这个初始值在后续的调用之中都会存在; 
        let _sum2 = curry( sum , [ 998 ] );

        let res4 = _sum2( 1,2,3 )
        console.log( res4 );

        // 可以动态创建函数, 函数之中自带一些数据; 
        let _sum3 = curry( sum , [ 1 , 2 , 3 ]);
        // _sum3(商品价格);
        console.log( _sum3( 998 ) );

        // 函数科里化有啥用 : 
        // 1. 可以让我们的函数分步骤执行 , 多次调用函数得到最终的执行结果； 
        // 2. 固定参数 , 我们后期的配置可以根据参数进行二次配置! 
        // 3. 参数复用 , 提取公用参数, 简化函数调用时的参数配置! 
        // 4. 动态创建函数 , 我们可以根据我们的需求创建不同语义的函数! 
        
    </script>   
</body>
</html>