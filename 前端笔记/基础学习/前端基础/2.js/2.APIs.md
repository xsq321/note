操作DOM BOM：比如控制网页元素交互等各种网页交互效果；

| 重点属性/方法                      | 作用                                                         |
| ---------------------------------- | ------------------------------------------------------------ |
| document.querySelector()           | 通过 css 选择器获取 DOM 元素，其他方式已淘汰                 |
| obj.innerText, obj.innerHTML       | 将内容添加/更新到任意标签内（除了表单，因为是单标签），前者只可添加文本，后者可解析标签 |
| box.classList.add('active')        | 通过classList方式追加和删除类名；remove()删除，toggle()切换（==有就删掉，没有就加上==） |
| setInterval(), setTimeout()        | 定时器：间歇函数，延时函数                                   |
| addEventListener('click',(e)=>{})  | 事件监听，绑定事件                                           |
| removeEventListener('click', fn)   | 解绑事件，因为监听事件可能会有多个回调函数，所以解绑事件时函数名必须是绑定的函数的其中一个，也就是说绑定时的回调函数一定要有函数名，供解绑时引用 |
| e.stopPropagation()                | 可以阻止事件冒泡与捕获                                       |
| e.preventDefault()                 | 阻止默认事件的触发，如 a 超链接的跳转、表单域跳转            |
| document.documentElement.scrollTop | 获取页面向下滚动的距离，scrollLeft 为向右滚动的距离；可读写  |
| `new Date().toLocaleString()`      | 获取当前时间并将其格式化为：`2023/4/3 15:58:06` 这种格式     |
| div.children, div.appendChild()    | 节点操作中比较重要的：获取元素子节点和为元素添加子节点       |
| JSON.stringify(), JSON.parse()     | 将复杂数据类型（如对象、数组）转为字符串；转回               |
| location.reload()                  | 该方法可用来刷新当前页面；传入参数 true 时表示强制刷新，类似 ctrl+f5 |
|                                    |                                                              |



#### 1. 基础

##### 1.1. Web API 基本认知

作用：使用 JS 去操作 html 和浏览器

分类：DOM（文档对象模型）、BOM（浏览器对象模型）

document 是最大的 DOM 对象，包含整个网页的所有内容，可通过 console.dir(document) 来了解 dom 对象里的详细内容；window 是最大的 BOM 对象

##### 1.2. 获取 DOM 对象

`document.querySelector('css选择器')`：通过 css 选择器获取 DOM 元素，其他方式了解即可；返回匹配到的第一个 DOM 元素对象

`document.querySelectorAll('css选择器')`：可以获取匹配到的所有标签，返回一个数组，注意就算只匹配到一个也返回数组

但其实返回的是一个伪数组，有长度有索引，但没有 push, pop 等数组方法

==拓展：还可以使用类似 `div.querySelector('选择器')` 的方式获取某个标签的子元素==

##### 1.3. 操作元素内容

obj.innerText 和 obj.innerHTML，前者只可添加文本，后者可解析标签

推荐直接使用 innerHTML

##### 1.4. 操作元素属性

元素常用属性：href、title、src 等

==元素样式属性==：通过 style 属性设置、通过类名（className）、通过 classList 操作类控制css

```js
const box = document.querySelector('.box')
box.style.width = '300px'		// 通过style属性引出，属性有-连接符则转为小驼峰命名，backgroundColor ；注意设置的是行内样式，所以权重会比较高
box.className = 'active'		//active是一个已经写好了样式的类，但这种方式会覆盖掉原有的类名
box.classList.add('active')		//通过classList方式追加类名；remove()删除，toggle()切换
```

表单元素属性：value、type、checked、disabled、selected

==自定义属性：data-自定义属性名==

```html
// 在标签上一律以 data- 开头；在DOM对象上一律以 dataset 对象的方式获取
<div data-id="myId"></div>
<script>
  let div = document.querySelector("div");
	console.log(div.dataset.id);	// myId
</script>
```

##### 1.5. 定时器

```js
let n = setInterval(()=>{},1000)		// 循环定时器；返回的是一个id数字
clearInterval(n)		// 关闭定时器
let timerId = setTimeout(()=>{},1000)		// 延时定时器
clearTimeout(timerId)		// 同样可关闭
```



#### 2. 事件监听

```
元素对象.addEventListener('事件类型', 要执行的函数)
```

addEventListener 可绑定多次，比如点击一下触发两个函数（以前的 `button.onclick = function(){}` 这种方式会覆盖掉前一个，因为这是赋值操作）

##### 2.1. 事件类型

| 事件类型                      | 作用                                                         |
| ----------------------------- | ------------------------------------------------------------ |
| click, mouseenter, mouseleave | 鼠标触发：鼠标点击，鼠标经过，鼠标离开。mouseenter 和 mouseleave 没有事件冒泡，如果需要冒泡可用 mouseover 和 mouseout 代替 |
| focus, blur                   | 表单获得光标：获得焦点，失去焦点                             |
| keydown, keyup                | 键盘触发：键盘按下，键盘抬起；可传入参数并通过 e.key 获得按下的键 |
| input                         | 表单输入触发：用户输入事件，                                 |
| load                          | 外部资源加载完毕时触发的事件                                 |
| DOMContentLoaded              | 当初始的 HTML 文档被加载解析后就触发                         |
| scroll                        | 滚动条在滚动的时候持续触发的事件                             |
| resize                        | 窗口尺寸改变时触发                                           |
| contextmenu                   | 鼠标右击事件，监听 document.documentElement 可修改默认右击事件 |
|                               |                                                              |

==可利用 js 自动调用事件：`button.click()` 可以直接触发 button 的点击事件，相当于点击了一下按钮==

##### 2.2. 事件对象

```js
btn.addEventListener('click',(e)=>{}) // e 就是事件对象，包含事件触发时的相关信息
```

| 常用属性/方法     | 作用                                               |
| ----------------- | -------------------------------------------------- |
| type              | 获取当前的事件类型                                 |
| clientX, clientY  | 获取光标相对于浏览器可见窗口左上角的位置           |
| pageX, pageY      | 获取光标在页面中的坐标                             |
| offsetX, offsetY  | 获取光标相对于当前DOM元素左上角的位置              |
| key               | 用户按下的键盘键的值，回车键为 'Enter'             |
| target            | 获取触发事件的 dom 元素对象（事件源）              |
| currentTarget     | 获取绑定事件的元素，因为事件可能会由子元素冒泡触发 |
| stopPropagation() | 可以阻止事件冒泡与捕获                             |
|                   |                                                    |

##### 2.3. 环境对象 this 

==指的是函数内部特殊的变量 this ，它代表着当前函数运行时所处的环境==

粗略规则：谁调用， this 就是谁

##### 2.4. 回调函数

如果将函数 A 作为参数传递给函数 B 时，我们称函数 A 为回调函数



#### 3. 事件流

事件流指的是事件完整执行过程中的流动路径，包括捕获阶段和冒泡阶段

##### 3.1. 事件捕获（了解）

从DOM的根元素开始去执行对应的事件，从外到里；事件捕获需要写对应代码才能看到效果（很少使用）

```
元素对象.addEventListener('事件类型', 要执行的函数, 是否使用捕获机制)
```

##### 3.2. 事件冒泡

当一个元素的事件被触发时，同样的事件将会在该元素的所有祖先元素中依次被触发。这一过程被称为事件冒泡

==默认一定会出现事件冒泡现象，除了：scroll, blur, focus, mouseenter, mouseleave 和 Media 事件==

##### 3.3. 阻止冒泡

```
事件对象.stopPropagation()
```

##### 3.4. 事件解绑

```
元素对象.removeEventListener('事件类型', 要解绑的函数名)
```

注意：匿名函数无法被解绑

##### 3.5. ==事件委托==

利用事件冒泡的特点，给父元素注册事件，代替给众多子元素注册事件

将多个子元素事件委托给共同的父元素，再通过 e.target 区分具体触发的子元素对象

 e.target.tagName 可以获取到事件源的标签名（全大写）



#### 4. 其他事件

##### 4.1. 页面加载事件

load：  给 window 添加 load 事件可以监听页面所有资源加载完毕；也可以给其他例如图片、外联css和js等外部资源添加该事件，表示等资源加载完毕后才执行某些代码

DOMContentLoaded：当初始的 HTML 文档被完全加载和解析完成之后就触发，无需等待样式表、图像等完全加载；一般添加给 document 用于监听页面 DOM 加载完毕（先于 window.load 事件）

##### 4.2. 页面滚动事件

scroll：添加给 window 可以监听整个页面滚动，当然也可以给某个元素添加。

当给某个元素添加该事件时，e.target.scrollTop 和 e.target.scrollLeft 可以获得滚动的距离（数字型，且可读写）。

但 window 比较特殊，window 就是 document ，想监听页面的滚动只能通过 window ，通过 html 和 body 都无效（原因不明），而要获得滚动的距离需要先获得 html 元素（ document 没有 scrollTop 属性）

==获取 html 元素写法：document.documentElement==

```js
window.addEventListener("scroll", (e) => {
  console.log(e.target.documentElement.scrollTop);
  console.log(document.documentElement.scrollTop) // 这种方式更直接，也方便重新赋值（可使页面滚动到指定位置）
});
```

了解：window.scrollTo(x,y) 可把页面滚动到指定的坐标

```css
html{ scroll-behavior: smooth; }		// 可以使页面的滚动产生滑动动画
```

##### 4.3. 页面尺寸事件

resize：浏览器窗口大小发生变化时触发

##### 4.4. 元素尺寸与位置

| 属性                      | 作用                                                         |
| ------------------------- | ------------------------------------------------------------ |
| scrollLeft, scrollTop     | 获取元素被卷去的头部和左侧长度，配合页面滚动来写；可读写     |
| clientWidth, clientHeight | 获取元素的可见部分宽高（不包含边框，margin，滚动条等，包含 padding ）；只读属性 |
| offsetWidth, offsetHeight | 获取包含边框的元素宽高；只读属性                             |
| offsetLeft, offsetTop     | 获取元素距离自己定位父级元素（没有则一直向外找直到 body ）的左、上距离；只读属性 |
| getBoundingClientRect()   | 可获取到元素在页面中的坐标与宽高（返回一个对象）             |

==注意：获取的是可视宽高，如果盒子是隐藏的，获取的结果为0==

##### 4.5. M 端事件（移动端事件）

移动端独特的事件：触屏事件 touch 

| 事件       | 说明                            |
| ---------- | ------------------------------- |
| touchstart | 手指触摸到一个 DOM 元素时触发   |
| touchmove  | 手指在一个 DOM 元素上滑动时触发 |
| touchend   | 手指从一个 DOM 元素上移开时触发 |



#### 5. 日期对象

| 方法                           | 作用                                                         |
| ------------------------------ | ------------------------------------------------------------ |
| `new Date()`                   | 获得当前时间；`new Date('2008-8-8 08:30:10')` 表示获取指定时间 |
| getFullYear(), getMonth(), ... | 可以分别获取年，月，日，时，分，秒；==注意除了年其它值都是从0开始的（包括月份，所以月份得加一才为正确值）== |
| toLocaleString()               | 获取格式化的时间，格式为：`2023/4/3 15:58:06`                |
| getTime()                      | 获取时间戳；类似功能：==+new Date()==, Date.now()            |
|                                |                                                              |

格式化时间函数可查看：曝气-技巧-6 



#### 6. 节点操作

DOM 树里每一个内容都称之为节点，包括元素节点、属性节点、文本节点、其他

| 属性/方法                                       | 作用                                                         |
| ----------------------------------------------- | ------------------------------------------------------------ |
| parentNode                                      | 得到最近一级的父节点                                         |
| childNodes, ==children==                        | 获得所有子节点；仅获得所有元素节点，返回一个伪数组           |
| nextElementSibling, previousElementSibling      | 下一个兄弟节点；上一个兄弟节点，当然只选元素节点             |
| document.createElement('标签名')                | 创建一个新的元素节点（标签）                                 |
| appendChild(), insertBefore(插入元素，指定元素) | 插入到父元素的最后一个子元素；插入到父元素中某个指定子元素的前面 |
| 元素.cloneNode(true)                            | 克隆一个跟原标签一样的元素， true 表示克隆时会包含后代节点一起克隆， false 则不包含后代节点，默认为 false |
| 父元素.removeChild(要删除的元素)                | 删除元素节点；要删除元素必须通过父元素删除                   |
|                                                 |                                                              |



#### 7. Window 对象

是一个全局对象，也可以说是 js 中的顶级对象；是 BOM（浏览器对象模型）中最大的对象

window 对象包含：navigator、location、==document==、history、screen

所有通过 var 定义在全局作用域中的变量、函数都会变成 window 对象的属性和方法；window 对象下的属性和方法调用的时候可以省略 window 

##### 7.1. location 对象

它拆分并保存了 URL 地址的各个组成部分

| 属性/方法 | 作用                                                         |
| --------- | ------------------------------------------------------------ |
| href      | 获取完整的 URL 地址，对 `location.href` 赋值可用于地址的跳转 |
| search    | 获取地址中携带的参数，符号 `?` 后面部分                      |
| hash      | 获取地址中的哈希值，符号 `#` 后面部分                        |
| reload()  | 该方法用来刷新当前页面，传入参数 true 时表示强制刷新（类似 ctrl+f5 ） |

 `location.href=''` 为本页面跳转， `open('')` 表示在新页面打开，`close()` 表示关闭当前页面

##### 7.2. navigator 对象

记录了浏览器自身的相关信息

userAgent 属性可检测浏览器的版本及平台，可用于判断是手机端还是 pc 端

##### 7.3. history 对象

主要管理历史记录，该对象与浏览器地址栏的操作相对应，如前进、后退、历史记录等

back()、forward() 分别用于页面后退和前进；go(参数) 方法中参数为数字，正数前进负数后退



#### 8. 本地存储

##### 8.1. localStorage

localStorage 可以将数据永久存储在本地（用户的电脑），除非手动删除，否则关闭页面也会存在，==且同一浏览器不同页面可以共享（只要是同一域名即可， localStorage 是根据域名来分类的）==

| 方法                             | 作用                                     |
| -------------------------------- | ---------------------------------------- |
| localStorage.setItem(key, value) | 存储数据；如果已经存在这个键则为修改数据 |
| getItem(key)                     | 获取数据                                 |
| removeItem(key)                  | 删除数据                                 |

本地存储只能存储字符串数据类型

##### 8.2. sessionStorage

生命周期为关闭浏览器窗口，只在同一个窗口（页面）下数据可以共享；用法跟 localStorage 基本相同



#### 9. 正则表达式

test() 可用来判断是否匹配，`/前端/.test('前端开发')` 返回 true ；exec() 类似，但返回的是一个数组

| 代码                       | 作用                                                         |
| -------------------------- | ------------------------------------------------------------ |
| ^, $                       | 边界符：匹配行首；匹配行尾                                   |
| *, +, ?, {n}, {n,}, {n,m}  | 量词：0或多次；1或多次；0或1次；n次；n次以上；n至m次         |
| [a-zA-Z0-9], `[^0-9]`      | 字符类：任意单个字母数字；非数字。注意中括号只选一个，多个需添加量词 |
| .                          | 匹配除换行符之外的任意单字符                                 |
| \d, \D, \w, \W, \s, \S, \b | 数字；非数字；任意字母数字和下划线，相当于`[a-zA-Z0-9_]`；非单词字符；任意空格，相当于`[\t\r\n\v\f]`；非空格；标注字符的边界（全字匹配） |
| \|                         | 或                                                           |
| i, g                       | 修饰符：表示不区分大小写；全局匹配                           |
| `/<.+>/` , `/<.+?>/`       | 贪婪匹配；懒惰匹配。例如在匹配 html 文件时 `<div></div>` ，贪婪匹配会匹配全部`<div></div>`，而懒惰匹配则是`<div>` |

`replace(/正则表达式/gi, '替换的文本')`  可用来替换字符串

