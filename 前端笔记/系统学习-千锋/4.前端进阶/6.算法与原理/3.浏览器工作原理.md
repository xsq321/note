#### 1. 什么是浏览器

##### 1.1. 标签页的进程

浏览器主进程，渲染进程，GPU进程，网络进程，插件进程

##### 1.2. 浏览器的结构

⽤户界⾯，浏览器引擎，渲染引擎（浏览器内核），网络，显示后端，JS 解释器，数据持久层

##### 1.3. 浏览器的请求过程

URL 检测：浏览器⾃动判断输⼊的是查询内容，还是正常的URL，如果是⽂本内容则拼接成新的 URL 进⾏请求，反之符合 URL 规则，直接按 URL 进⾏访问

查找缓存：真正发起网络请求之前，浏览器会先在数据存储中查询是否有需要请求的⽂件，如果没有任何缓存，说明第⼀次请求，则进⼊⽹络请求过程，当浏览器有缓存的时候，会拦截请求，返回缓存。先判断文件是否过期，没过期触发==强制缓存==，浏览器直接读取本地文件，http 状态码200；如果文件已经过期了，触发==协商缓存==，发起请求询问服务器该文件是否有更新，没有更新则使用本地文件，http 状态码304，有更新则服务器返回新的文件给客户端，http 状态码200

DNS 域名解析过程：浏览器缓存——》系统 hosts ⽂件——》本地 DNS 解析器缓存——》本地域名服务器——》根域名服务器——》顶级域名服务器 ——》权限域名服务器

##### 1.4. 建立 TCP 连接

TCP 连接建⽴后，浏览器就可以利⽤ HTTP／HTTPS 协议向服务器发送请求了。服务器接受到请求，就解析请求头，如果头部有缓存相关信息如 if-none-match 与 if-modified-since ，则验证缓存是否有效，若有效则返回状态码为 304，若⽆效则重新返回资源，状态码为 200

三次握手，四次挥手

##### 1.5. 浏览器解析 HTML 并布局渲染

浏览器通过解析 HTML 生成 DOM 树，解析 CSS 生成 CSS 规则树，然后通过 DOM 树和 CSS 规则树生成渲染树。

渲染进程：GUI 渲染线程，JS 引擎线程，事件触发线程，定时触发器线程，异步 http 请求线程

##### 1.6. js 解析引擎

JavaScript 解析引擎就是能够“读懂” JavaScript 代码，并准确地给出代码运⾏结果的⼀段程序。

解析过程：语法检查阶段和运行阶段，语法检查包括词法分析和语法分析，运⾏阶段包括预解析和运⾏阶段



#### 2. js 执行机制

- 先同步后异步，同步需要考虑变量、函数的预处理阶段，var 声明提前等

- 异步中任务队列的执行顺序： 先微任务 microtask 队列，再宏任务 macrotask 队列

异步任务中除了 Promise.then 和 this.$nextTick 是微任务外其他大部分都是宏任务，具体参考 前端基础 - js 执行顺序



#### 3. ==V8 引擎的工作原理==

V8 引擎主要能力是将 JavaScript 源码解释编译，并运⾏。现阶段的⼯作机制可以分为以下⼏个阶段：

- Parser：解析器，将 JS 源码解析为 AST（抽象语法树，Abstract Syntax Tree）；

- Ignition：基于寄存器的解释器，⽤于将 AST 转换为字节码（字节码可以跨平台）

- TurboFan：基于 Ignition 生成的字节码，生成对应平台（windows，mac，linux）的机器码，并对其进⾏优化和反优化。



#### 4. 浏览器中的页面

##### 4.1. 渲染的流程

- 构建 DOM 树：将 HTML 字符串转换为浏览器可以识别的 DOM 树状结构

- 将 CSS 解析成 CSSOM：将 CSS 代码和内敛 CSS 代码解析成浏览器可以理解的结构 styleSheets

- 构造 Render Tree：根据 DOM 树和 CSSOM 构建 Render Tree，其中只包含可⻅元素，像 head 标签或是 display: none 的标签就不在渲染树中

- 布局计算（样式计算）：根据刚刚计算出的渲染树计算树中节点的坐标位置

- 对布局树进⾏分层，并生成分层树。

- 为每个图层生成绘制列表，并将其提交到合成线程。合成线程将图层分图块，并栅格化将图块转换成位图。

- 合成线程发送绘制图块命令给浏览器进程。浏览器进程根据指令生成⻚⾯，并显示到显示器上。

##### 4.2. 回流重绘

在布局计算时会出现的问题

回流：回流是布局或者⼏何属性需要改变就称为回流。回流是影响浏览器性能的关键因素，因为其变化涉及到部分⻚⾯（或是整个⻚⾯）的布局更新。⼀个元素的回流可能会导致了其所有⼦元素以及 DOM 中紧随其后的节点、祖先节点元素的随后的回流。

重绘：重绘是由于节点的⼏何属性发⽣改变或者由于样式发⽣改变但不会影响布局。例如 outline, visibility, color、background-color 等，重绘的代价是⾼昂的，因为浏览器必须验证 DOM 树上其他节点元素的可⻅性。

回流⼀定会触发重绘，重绘不⼀定会导致回流



#### 5. 浏览器安全

##### 5.1. XSS 跨站脚本

XSS 攻击是指⿊客往 HTML ⽂件中或者 DOM 中注⼊恶意脚本，从⽽在⽤户浏览⻚⾯时利⽤注⼊的恶意脚本对⽤户实施攻击的⼀种⼿段

##### 5.2. CSRF 攻击

跨站请求伪造攻击，主要就是利⽤⽤户的登录状态发起跨站请求，它实现的核⼼就是伪造带有正确 Cookie 的 http请求，直接绕过后台的登录验证，然后冒充⽤户执⾏⼀些操作。

##### 5.3. 中间人攻击

从⽤户的客户端到服务器整个申请的过程中，其中要经历很多的环节，这个过程中存在诸多的不安全信息，过程中容易被中间⼈窃取、伪造、篡改，这种攻击⽅式称为中间⼈攻击



#### 6. 浏览器应用实践

Chrome DevTools 由以下九部分组成：

- Element 元素⾯板：检查和调整⻚⾯，调式 DOM，调试 CSS

- Network 网络⾯板：调试请求，了解⻚⾯静态资源分布以及⽹⻚性能的检测

- Console 控制台⾯板：调试 JavaScript。查看 Console log ⽇志、交互式代码调试

- Sources 源代码资源⾯板：调试 JavaScript ⻚⾯源代码，进⾏断点调试代码

- Application 应⽤⾯板：查看、调试客户端存储，如 Cookie、LocalStorage、SessionStorage 等

- Performance 性能⾯板：查看⽹⻚的细节，细粒度对⽹⻚载⼊进⾏性能优化

- Memory 内存⾯板： JavaScript CPU 分析器，内存堆分析器

- Security 安全⾯板： 查看网页安全及证书问题

- LightHouse ⾯板：进⾏性能分析，给出优化建议

- layers ：可视化⻚⾯的分层情况



