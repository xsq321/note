#### 1. 编译原理概述

平时使⽤的⾼级语⾔是怎么被转换成机器语⾔被执⾏，以及不同⾼级语⾔之间如何进⾏转换，⽐如 ts 转 js 、⾼版本 js 转低版本 js ，这个过程我们统称为编译。

低级语言：机器语言，汇编语言

高级语言：编译型语言（C, C++ 等），解释性语言（Java, JavaScript 等）



#### 2. Babel

Babel 是 ES 语法编译器，Babel 在前端⼯具链中占据了⾮常重要的地位，它严格按照 ECMA-262（ECMA-262 是ECMAScript5.1 的规范）语⾔规范，实现对最新语法的解析，⽽⽆需等待浏览器升级来提供对新特性的⽀持。

Babel 主要⽤于将采⽤ ECMAScript 语法编写的代码转换为向后兼容的 JavaScript 语法，并且还可以把⽬标环境不⽀持的 api 进⾏ polyfill (⼀个 js 库，主要抚平不同浏览器之间对 js 实现的差异)，以便能够运⾏在当前和旧版本的浏览器或其他环境中。

##### 2.1. parse 阶段

这个阶段将原始代码字符串转为 AST 树，parse 阶段主要包括了编译流程中的词法分析、语法分析这两个阶段。

parse 过程中会有⼀些 babel 插件，让 babel 可以解析出更多的语法，⽐如 jsx, ts, flow 等。

##### 2.2. transform 阶段

transform 这⼀环节主要是对上⼀步 parse ⽣成的 AST 进⾏深度优先遍历，从⽽对于匹配节点进⾏增删改查来修改树形结构。

在 babel 中会⽤所配置的 plugin 或 presets 对 AST 进⾏修改后，得到新的 AST，我们的 babel 插件⼤部分⽤于这个阶段。

##### 2.3. generate 阶段

由于 Babel 的定位仅仅是对 ES 语法的转换，所以语义分析阶段、⽣成中间代码⼯作可以交给 JS 解释器引擎来处理。

⽽ Babel 最为特⾊的部分是它的插件机制，针对不同的浏览器版本环境，调⽤不同的 Babel 插件。通过访问者模式（⼀种设计模式）的接⼝定义，对 AST 进⾏⼀遍深度优先遍历，对指定的匹配到的结点进⾏修改、删除、新增、移位，使原先的 AST 转换为另⼀棵经过修改的 AST。

AST 转换完之后就要输出⽬标代码字符串，这个阶段是个逆向操作，⽤新的 AST 来⽣成我们所需要的代码，在生成阶段本质上也是遍历抽象语法树，根据抽象语法树上每个节点的类型和属性递归调⽤从⽽生成对应的字符串代码，即经过 babel 编译后的代码



