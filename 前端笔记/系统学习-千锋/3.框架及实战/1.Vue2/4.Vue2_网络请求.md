#### 1. axios 基本使用

```js
npm i axios  //在终端下载
import axios from 'axios'  //引入
axios({
    method:'POST',
    url:'/xxx',
    params:{},
    headers:{ 'Content-Type':'application/json;charset=utf-8' },
    data:{}，	//请求体参数，只有post请求有
}).then(res => {}).catch(err =>)
```



#### 2. axios 二次封装

新建 api 文件夹，下面新建 request.js 文件

```js
import axios from 'axios'

axios.defaults.headers['Content-Type'] = 'application/json;charset=utf-8'
// 创建axios实例
const instance = axios.create({
  // axios中请求配置有baseURL选项，表示请求URL公共部分
  baseURL: 'http://localhost:3000',
  // 超时
  timeout: 10000,
})

// request拦截器
instance.interceptors.request.use(
  // config形参将接收对象，含有网络请求的配置，其实就是具体发送请求时的配置，包含method,url,data等
  (config) => {
    // 在发送请求之前做些什么，比如可对config中的配置进行修改，统一加token等
    config.headers.token = token  // token 一般放在请求头
    return config;	// 将修改之后的配置返回
  },
  (err) => {
    console.log(err)
    Promise.reject(err)
  }
)

// 响应拦截器
instance.interceptors.response.use(
  (res) => {
    // 对响应数据做点什么
    return res.data;	// 直接返回需要的那部分数据
  },
  (err) => {
    return Promise.reject(err)
  }
)

export default instance
```

在 api 文件夹下创建对应的 js 文件（对大型项目可用文件夹再进行分类）

```js
import request from './request.js' 

//查询指定好氧池下的所有子单元
export function allAerobicSubunit(tankId) {
  return request({
    url: '/aeration/aerobic-tank-subunit/aerobic_tank/' + tankId,
    method: 'get',
  })
}

//通过id查询好氧池子单元
export function getAerobicSubunit(subunitId) {
  return request({
    url: '/aeration/aerobic-tank-subunit/' + subunitId,
    method: 'get',
    // data:data  // post、put 等请求才有data
  })
}
```

然后在具体的组件中引入需要的方法并使用即可： `allAerobicSubunit(id).then(res=>{})`



#### 3. 配置代理服务器

先将请求发送给和浏览器相同协议、域名、端口的本地代理服务器（一般是 http://localhost:8080/ ），然后再由这个服务器去向真正的服务器地址发送请求

在项目根文件目录下新建 vue.config.js 文件

```javascript
module.exports = {
  devServer: {
    proxy: {
      '/api': {    //	请求前缀，相同就走这条代理
        target: 'http://localhost:3000',	// 真正请求的服务器地址
        pathRewrite:{'^/api':''}  //转发请求时，将添加的请求前缀去掉
        ws: true,  //用于支持websocket
        changeOrigin: true  //用于控制请求头中的host值
      },
      '/foo': {
        target: '<other_url>'
      }
    }
```

发送请求时需写成 `axios.get('/api/...')` ；对于 axios 的二次封装则需要将 baseURL 改写成 '/api'

实际开发中需要区分好开发模式与生产模式，代理服务器只对开发模式生效；生产模式也不需要考虑跨域问题，但请求为 `axios.get('/api/...')` 这种形式时在项目上线后肯定会报错，因为生产模式不走代理，可用以下类似方式区分生产与开发模式；或者直接在 .env.development 和 .env.production 文件中添加一个 BASE_URL 属性

```js
url: process.env.NODE_ENV === 'development' ? '/access/accessToken' : 'http://124.70.195.185:8090/accessToken',
```

对于 axios 的二次封装也可将 baseURL 用类似的方式进行区分

