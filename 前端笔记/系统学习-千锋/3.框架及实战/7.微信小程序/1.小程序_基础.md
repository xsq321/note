微信公众平台：https://mp.weixin.qq.com/ ，点击文档可进入开发文档

注册小程序开发账号 - 下载微信开发者工具 - 创建项目即可

AppID ：开发管理 - 开发设置



#### 1. 小程序配置

详细配置项：https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html

##### 1.1. 全局配置 app.json

pages ：用于指定小程序的页面组成；可直接添加页面路径，保存后会自动创建相应文件；默认第一项是首页

window ：用于设置小程序的状态栏、导航条、标题、窗口背景色。

tabBar ：用于设置导航栏

##### 1.2. 页面配置

app.json 中的部分配置，也支持对单个页面进行配置，可以在页面对应的 .json 文件中对本页面的表现进行配置，使每个页面有其独特的表现，页面中的配置项会覆盖 app.json 中 window 属性的配置项。

如 navigationBarTitleText 可以设置每个页面自己的标题

##### 1.3. sitemap.json 配置

根目录下的 `sitemap.json` 文件用于配置小程序及其页面是否允许被微信索引，以及指定索引规则



#### 2. 基本语法

##### 2.1. 数据绑定

```html
<text>{{count}}</text>
```

在页面对应的 .js 文件的 data 里可以定义变量初始值，页面中通过双大括号的形式进行展示，可在双大括号中书写 js 表达式

##### 2.2. 列表渲染

```html
<view wx:for="{{list}}" wx:for-item="itemName" wx:for-index="itemIndex"  wx:key="itemIndex">
  {{itemIndex}}-{{itemName}}
</view>
```

wx:for-item 和 wx:for-index 可以指定当前元素的变量名与下标名，不写则默认为 item 和 index ；wx:key 指定每项的唯一标识符

##### 2.3. 条件渲染

```html
<view wx:if="{{isShow}}">内容</view>
```

也可以用 `wx:elif` 和 `wx:else` 来添加一个 else 块

类似的还有 hidden 属性，用于显示和隐藏，和 v-show 功能类似

##### 2.4. 事件绑定

事件详情：https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html

```html
<button type="primary" bindtap="addCount" data-val="2">count+2</button>
```

事件的绑定使用 "bind + 事件名" ，tap 表示手指触摸后马上离开，即点击事件；也可以用 catch 来绑定事件，与 bind 不同，catch 会阻止事件向上冒泡。

```js
addCount(event){  // 默认会传递 event 参数，也只能传递该参数
  let val = +event.target.dataset.val  // 需通过 data-xxx 传递参数，通过 dataset.xxx 获取
  this.setData({ count: this.data.count + val }) // 变量的修改，通过 this.data 访问
},
```

函数的定义写在对应的 .js 文件中，和 data 平级；获取参数一般用 currentTarget ，防止冒泡误导；input 输入框的 value 需通过 e.detail.value 获取

##### 2.5. wxss 语法

具有 CSS 大部分特性，但进行了一定的扩充及修改：

- 不支持 rem ，而是改用 rpx ；屏幕总宽度为 750rpx ，相当于 100% 

- 可使用 @import 导入外联样式表，需用 ";" 表示结束

##### 2.6. wxs 语法

双大括号中不可以直接调用 .js 文件中定义的函数，只能供事件绑定，若是需要直接调用函数就需要用到 wxs ，类似 script 标签，可直接在 `<wxs></wxs>` 中编写 WXS 脚本（如定义函数供页面调用），也可创建 .wxs 文件供 wxs 标签引入

```html
<wxs module="test">  // 引入使用 src 属性，但仅当本标签为单闭合标签或标签的内容为空时有效
  function getNum() {
    return 6
  }
  var msg = 'hello'  //不支持 let 
  module.exports = {
    getNum: getNum,
    msg: msg  // 不支持 es6 省略写法
  }
</wxs>

<view>num: {{test.getNum()}}</view>  // 需使用"模块.xxx"使用
<view>msg: {{test.msg}}</view>
```

wxs 不支持 es6 语法，包括 let，箭头函数等

##### 2.7. 页面生命周期

就是创建页面时 .js 文件中的那些生命周期函数，如 onLoad, onUnLoad



#### 3. 数据请求

```js
wx.request({
  url: 'url',
  method: 'get',
  data:{},  // 请求体参数（仅 post 有）
  success: ()=>{},  // 成功的回调函数
  fail: ()=>{},  // 失败的回调函数
})
```

没有跨域限制，因为根本就不是浏览器；但出于安全考虑需要在小程序后台中配置合法域名：开发管理 - 开发设置 - 服务器域名；或者可以暂时先关闭校验：开发者工具右上角详情 - 本地设置 - 不校验...



#### 4. 内置组件

详细文档：https://developers.weixin.qq.com/miniprogram/dev/component/

| 组件名      | 作用                                                         |
| ----------- | ------------------------------------------------------------ |
| text        | 相当于行内标签                                               |
| view        | 相当于块级标签                                               |
| button      | 按钮，`<button type="primary" size="mini"></button>`         |
| wxs         | 可在里面编写 WXS 脚本，类似 script 标签                      |
| image       | 图片，`<image src="url" mode="widthFix" />`                  |
| swiper      | 轮播图组件，内部只能放 swiper-item 组件                      |
| scroll-view | 可滚动视图区域；可监听一些事件，如滚动到底部等，可用于长列表的懒加载 |
| icon        | 图标，`<icon color="red" type="success" size="30"></icon>`   |
| checkbox    | 多选框；点击时自动触发 checkbox-group 的 change 事件，当然也可为每个 checkbox 单独绑定 tap 点击事件 |
| ...         |                                                              |



#### 5. 自定义组件

在根目录下新建 components 文件夹，下建 navbar 文件夹，右击新建 Component ，输入组件名称后会自动创建所需文件

在需要使用自定义组件的页面的 .json 文件中引入：

```json
{
  "usingComponents": {
    "navbar": "../../components/navbar/navbar"
  }
}
```

在 .wxml 中就可以直接使用 navbar 这个组件标签了

##### 5.1. 父传子

在子组件 navbar.js 中定义组件的属性列表：

```js
properties: {
  datalist: {
    type: Array,  // 数据类型
    value: ['初始值']  // 初始值
  },
},
```

父组件中传入参数：

```html
<navbar datalist="{{['数据1', '数据2','数据3']}}"></navbar>
```

##### 5.2. 子传父

类似自定义事件，父组件绑定事件：

```html
<navbar bindMyEvent="getParam"></navbar>  // 父组件通过 getParam 函数接收参数
```

子组件触发并传参：

```js
this.triggerEvent("MyEvent", '参数')  // 注意事件名不要加 bind
```

##### 5.3. slot 插槽

父组件：

```html
<navbar>
  <view slot="slot1">内容1</view>
</navbar>
```

子组件：

```html
<slot name="slot1"></slot>
```

默认情况下，只允许有一个插槽，且不能使用具名插槽，想使用的话需要在子组件 js 中声明启用。

```js
options: {  // 和 data 等平级
  multipleSlots: true
},
```

##### 5.4. 自定义组件的生命周期

```js
lifetimes: {  // 和 data 等平级
  attached: function() {},  // 挂载完成时执行
  detached: function() {},  // 销毁之后执行
},
```

当然还有其他生命周期，详细查看文档



#### 6. 页面跳转

```js
wx.navigateTo({
  url: '/pages/.../...?id=1',  //非 tabBar 页面的路径，且可传参
})

// 跳转到的页面可通过 onLoad 生命周期获取到参数
onLoad(options){
  console.log(options)
}
```

使用 wx.navigateBack 可以返回到原页面，但其实通过 navigateTo 跳转的页面会自带返回按钮

其他路由跳转方法：redirectTo, switchTab, 



